var el = $('#add-cate-dialog');
<% if @category.errors.any? %>
  var errors = $('<div class="ui-state-highlight ui-corner-all" style="padding:0 .7em"></div>');
  <% @category.errors.full_messages.each do |error| %>
    $('<p><span class="ui-icon ui-icon-alert" style="float:left;margin-right:.3em"></span><%= escape_javascript(error) %></p>').appendTo(errors);
  <% end %>
  errors.appendTo('<div class="ui-widget"></div>');
  el.children(":first").html(errors);
<% else %>
  el.dialog("close");
  var tr = $('<tr><td><%= escape_javascript(@category.name) %></td><td><%= @category.ideas.count %></td></td></tr>');
  var btn1 = $('<%= link_to "删除",@category,:method => :delete,:remote => true,:confirm => '确认删除？',:class => "cate-del" %>').button({
      text: false,
      icons: {
          primary: "ui-icon-trash"
      }
  }).bind("ajax:success", function(evt, data, status, xhr){
    $(this).parent().parent().remove();
  }).bind('ajax:error', function(evt, xhr, status, error){
    var errors = $.parseJSON(xhr.responseText);
    alert(errors.base);
  });

  td = $("<td></td>").append(btn1);
  var btn2 = $('<button class="cate-edit">修改</button>').button({
      text: false,
      icons: {
          primary: "ui-icon-pencil"
      }
  }).click(function(){
      alert("edit");
  });
  tr.append(td.append(btn2));
  $('#cate-last').before(tr);
  el.find('input:text,textarea').val('');
  el.children(":first").empty();
<% end %>
